<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darija Explorer: Learn Moroccan Arabic</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-purple: #6a0dad;
            --secondary-purple: #8a2be2;
            --light-purple: #f5e6ff;
            --dark-purple: #4b0082;
            --accent-pink: #da70d6;
            --background-gradient-start: #f8f0ff;
            --background-gradient-end: #e8d0f5;
            --card-shadow-light: rgba(176, 141, 255, 0.4);
            --card-shadow-dark: rgba(176, 141, 255, 0.7);
            --text-shadow-light: rgba(0,0,0,0.1);
            --text-shadow-dark: rgba(0,0,0,0.2);
            --border-color-light: #edd5ff;
            --input-border: #b39cd0;
            --input-focus-shadow: rgba(138, 43, 226, 0.4);
            --correct-color: #4CAF50;
            --incorrect-color: #FF4500;
        }

        html, body {
            height: 100%; /* Ensure html and body take full height */
            margin: 0;
            padding: 0; /* Added: Remove default padding */
            overflow: hidden; /* Added: Prevent body scrollbars */
        }

        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, var(--background-gradient-start) 0%, var(--background-gradient-end) 100%);
            color: var(--dark-purple);
            /* Removed: padding here, as app-container handles its own padding */
            box-sizing: border-box;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .app-container {
            width: 100%;
            height: 100%; /* Make app-container take available height */
            max-width: 1000px; /* Keep this if you want horizontal constraint */
            background: linear-gradient(180deg, #fefeff 0%, var(--light-purple) 100%);
            padding: 40px;
            border-radius: 35px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.35);
            text-align: center;
            box-sizing: border-box;
            animation: fadeIn 1.2s ease-out forwards;
            position: relative; /* Crucial for absolute positioning of pages */
            overflow: hidden; /* Crucial to clip page transitions */
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align content to the top of the container */
            align-items: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-70px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-family: 'Playfair Display', serif;
            color: var(--primary-purple);
            margin-bottom: 30px;
            font-size: 3.2em;
            text-shadow: 1px 1px 6px var(--text-shadow-dark);
            line-height: 1.2;
        }

        h2 {
            font-family: 'Playfair Display', serif;
            color: var(--secondary-purple);
            font-size: 2em;
            margin-bottom: 20px;
            text-shadow: 1px 1px 3px var(--text-shadow-light);
        }

        .page-content {
            position: absolute; /* Make pages overlap inside app-container */
            top: 0;
            left: 0;
            width: 100%; /* Take full width of app-container */
            height: 100%; /* Take full height of app-container */
            padding: 40px; /* Padding for content within each page */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* Default: content starts from top */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            pointer-events: none;
            visibility: hidden;
            overflow-y: auto; /* Crucial: Enable vertical scrolling for page content */
            -webkit-overflow-scrolling: touch;
        }

        .page-content.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
            visibility: visible;
        }

        .primary-card, .category-card, .action-button {
            border: none;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1), box-shadow 0.3s ease, background 0.3s ease;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            flex-shrink: 0;
        }

        .primary-card:hover, .category-card:hover, .action-button:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 45px var(--card-shadow-dark);
        }

        .primary-card:active, .category-card:active, .action-button:active {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px var(--card-shadow-light);
        }

        .main-home-page {
            justify-content: center; /* Keep main home content centered vertically */
            gap: 40px;
        }

        .main-category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            padding: 0;
            width: 100%;
            max-width: 600px;
        }

        .primary-card {
            background: linear-gradient(180deg, #ffffff 0%, #f9f0ff 100%);
            color: var(--primary-purple);
            padding: 30px 25px;
            border-radius: 25px;
            font-size: 1.6em;
            font-weight: 700;
            box-shadow: 0 10px 25px var(--card-shadow-light);
            min-height: 180px; /* Keep min-height for consistent card size */
        }

        .primary-card span {
            font-size: 0.6em;
            font-weight: 400;
            color: var(--dark-purple);
            margin-top: 10px;
        }

        .primary-card i {
            font-size: 3.5em;
            color: var(--secondary-purple);
            margin-bottom: 12px;
        }

        .learn-categories-page, .practice-categories-page {
            justify-content: center; /* Keep category pages centered vertically */
            gap: 30px;
        }

        .learn-definitions-page {
            gap: 20px;
            text-align: left;
            /* background-color: #fcf8ff; Removed this for the whole screen look as it restricts the background */
            border-radius: 20px;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.05); /* Keep a subtle inner shadow */
            padding: 25px; /* Keep internal padding */
            justify-content: flex-start; /* Ensure content starts from top for scrolling */
        }

        .learn-definitions-page h1 {
            font-size: 2.5em;
            margin-bottom: 25px;
            color: var(--primary-purple);
            text-align: center;
            width: 100%;
        }

        .learn-word-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            width: 100%;
        }

        .learn-word-item {
            background-color: #f9f0ff;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1em;
        }
        .learn-word-item .english-word {
            font-weight: 600;
            color: var(--dark-purple);
            flex-grow: 1;
            margin-right: 10px;
        }
        .learn-word-item .darija-word {
            font-style: italic;
            color: var(--secondary-purple);
            white-space: nowrap;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            padding: 0;
            width: 100%;
        }

        .category-card {
            background: linear-gradient(180deg, #ffffff 0%, #f9f0ff 100%);
            color: var(--primary-purple);
            padding: 25px 15px;
            border-radius: 20px;
            font-size: 1.2em;
            font-weight: 600;
            box-shadow: 0 8px 20px var(--card-shadow-light);
            min-height: 140px; /* Keep min-height for consistent card size */
        }

        .category-card i {
            font-size: 2.8em;
            color: var(--secondary-purple);
            margin-bottom: 12px;
            transition: transform 0.3s ease;
        }
        .category-card .emoji-icon {
            font-size: 3em;
            line-height: 1;
            margin-bottom: 12px;
            transition: transform 0.3s ease;
        }

        .category-card:hover i, .category-card:hover .emoji-icon {
            transform: scale(1.08);
        }

        .game-page {
            justify-content: flex-start; /* Align content to the top within game page */
            gap: 25px;
        }

        .score-display {
            font-size: 1.5em;
            font-weight: 700;
            color: #7b68ee;
            margin-top: 10px;
            background-color: #f0e6ff;
            padding: 15px;
            border-radius: 18px;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.12);
            width: 100%;
            max-width: 300px;
        }

        .question-display {
            font-family: 'Playfair Display', serif;
            font-size: 3.5em;
            font-weight: 700;
            margin-bottom: 30px;
            color: #331a33;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(180deg, #ffffff 0%, var(--light-purple) 100%);
            padding: 30px;
            border-radius: 25px;
            box-shadow: inset 0 5px 15px rgba(0, 0, 0, 0.2);
            word-break: break-word;
            white-space: normal;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            width: 100%;
            box-sizing: border-box;
            max-width: 700px;
        }

        .answer-input {
            width: calc(100% - 40px);
            padding: 18px 25px;
            margin-bottom: 25px;
            background-color: #ffffff;
            color: #331a33;
            border: 2px solid var(--input-border);
            border-radius: 20px;
            font-size: 1.4em;
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
            box-sizing: border-box;
            max-width: 500px;
        }

        .answer-input::placeholder {
            color: #8c78a0;
        }

        .answer-input:focus {
            border-color: var(--secondary-purple);
            box-shadow: 0 0 0 7px var(--input-focus-shadow);
            background-color: #fdfbff;
        }

        .action-button {
            background: linear-gradient(180deg, var(--accent-pink) 0%, #b258ae 100%);
            color: white;
            padding: 18px 35px;
            border-radius: 20px;
            font-size: 1.5em;
            font-weight: 700;
            box-shadow: 0 10px 25px rgba(218, 112, 214, 0.6);
            width: 100%;
            max-width: 400px;
        }

        .feedback-message {
            margin-top: 20px;
            font-size: 1.4em;
            font-weight: 700;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-word;
            width: 100%;
            text-align: center;
        }

        .feedback-message.correct {
            color: var(--correct-color);
        }

        .feedback-message.incorrect {
            color: var(--incorrect-color);
        }

        .back-button {
            position: absolute;
            top: 25px;
            left: 25px;
            background: none;
            border: none;
            color: var(--secondary-purple);
            font-size: 2em;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
            padding: 10px;
            border-radius: 15px;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transform: translateX(-10px);
            transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s ease;
        }

        .back-button.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }

        .back-button:hover {
            color: var(--primary-purple);
            transform: scale(1.15);
        }

        /* --- Media Queries for Responsiveness --- */

        @media (max-width: 900px) {
            .app-container {
                padding: 30px;
            }
            h1 {
                font-size: 2.8em;
                margin-bottom: 25px;
            }
            .primary-card {
                font-size: 1.4em;
                padding: 25px 20px;
                min-height: 160px;
            }
            .primary-card i {
                font-size: 3em;
            }
            h2 {
                font-size: 1.8em;
            }
            .learn-definitions-page h1 {
                 font-size: 2.2em;
            }
            .learn-word-list {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            .question-display {
                font-size: 3em;
                padding: 25px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 0; /* Changed: Remove body padding for smaller screens too */
            }
            .app-container {
                padding: 25px;
                border-radius: 25px;
                /* min-height: unset; Let content dictate height */
            }
            .page-content {
                padding: 25px;
            }
            h1 {
                font-size: 2.4em;
                margin-bottom: 20px;
            }
            .main-category-grid {
                grid-template-columns: 1fr;
                max-width: 350px;
                gap: 20px;
            }
            .primary-card {
                font-size: 1.3em;
                padding: 25px 20px;
                min-height: 150px;
            }
            .primary-card i {
                font-size: 2.8em;
            }
            h2 {
                font-size: 1.6em;
            }
            .learn-definitions-page h1 {
                 font-size: 2em;
                 margin-bottom: 20px;
            }
            .learn-word-list {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            .learn-word-item {
                padding: 12px 15px;
                font-size: 0.95em;
            }
            .category-grid {
                grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
                gap: 15px;
            }
            .category-card {
                font-size: 1.1em;
                padding: 20px 10px;
                min-height: 120px;
                border-radius: 15px;
            }
            .category-card i, .category-card .emoji-icon {
                font-size: 2.5em;
                margin-bottom: 10px;
            }
            .question-display {
                font-size: 2.5em;
                padding: 20px;
                min-height: 80px;
                margin-bottom: 20px;
            }
            .answer-input {
                font-size: 1.1em;
                padding: 15px 20px;
                border-radius: 15px;
                margin-bottom: 15px;
            }
            .action-button {
                font-size: 1.2em;
                padding: 15px 25px;
                border-radius: 15px;
            }
            .feedback-message {
                font-size: 1.1em;
                min-height: 35px;
                margin-top: 15px;
            }
            .back-button {
                font-size: 1.8em;
                top: 18px;
                left: 18px;
                padding: 8px;
            }
        }

        @media (max-width: 480px) {
            .app-container {
                padding: 20px;
                border-radius: 20px;
                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
            }
            .page-content {
                padding: 20px;
            }
            h1 {
                font-size: 2em;
                margin-bottom: 15px;
            }
            .primary-card {
                font-size: 1.2em;
                padding: 20px 15px;
                min-height: 130px;
            }
            .primary-card i {
                font-size: 2.5em;
            }
            h2 {
                font-size: 1.4em;
                margin-bottom: 15px;
            }
            .learn-definitions-page h1 {
                 font-size: 1.8em;
                 margin-bottom: 15px;
            }
            .learn-word-item {
                font-size: 0.9em;
                padding: 10px 12px;
            }
            .category-grid {
                grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
                gap: 10px;
            }
            .category-card {
                font-size: 1em;
                padding: 18px 8px;
                min-height: 100px;
            }
            .category-card i, .category-card .emoji-icon {
                font-size: 2.2em;
                margin-bottom: 8px;
            }
            .question-display {
                font-size: 2em;
                padding: 15px;
                min-height: 70px;
                margin-bottom: 15px;
            }
            .answer-input {
                font-size: 1em;
                padding: 12px 15px;
            }
            .action-button {
                font-size: 1.1em;
                padding: 12px 20px;
            }
            .feedback-message {
                font-size: 1em;
                min-height: 30px;
                margin-top: 12px;
            }
            .back-button {
                font-size: 1.5em;
                top: 10px;
                left: 10px;
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <button id="backButton" class="back-button" aria-label="Go back">
            <i class="fas fa-arrow-left"></i>
        </button>

        <div id="mainHomePage" class="page-content main-home-page">
            <h1>Darija Explorer</h1>
            <div class="main-category-grid">
                <button class="primary-card" data-target-page="learnCategoriesPage">
                    <i class="fas fa-book-open"></i> Learn
                    <span>Explore words & definitions</span>
                </button>
                <button class="primary-card" data-target-page="practiceCategoriesPage">
                    <i class="fas fa-gamepad"></i> Practice
                    <span>Play interactive games</span>
                </button>
            </div>
        </div>

        <div id="learnCategoriesPage" class="page-content learn-categories-page">
            <h1>Learn Darija Words</h1>
            <div class="category-grid">
                <button class="category-card" data-category-key="numbers">
                    <i class="fas fa-calculator"></i> Numbers
                </button>
                <button class="category-card" data-category-key="days">
                    <i class="fas fa-calendar-alt"></i> Days of the Week
                </button>
                <button class="category-card" data-category-key="months">
                    <i class="fas fa-calendar-check"></i> Months
                </button>
                <button class="category-card" data-category-key="colors">
                    <i class="fas fa-palette"></i> Colors
                </button>
                <button class="category-card" data-category-key="animals">
                    <i class="fas fa-paw"></i> Animals
                </button>
                <button class="category-card" data-category-key="food">
                    <i class="fas fa-utensils"></i> Food
                </button>
                <button class="category-card" data-category-key="greetings">
                    <i class="fas fa-handshake"></i> Greetings
                </button>
                <button class="category-card" data-category-key="family">
                    <i class="fas fa-users"></i> Family
                </button>
                <button class="category-card" data-category-key="bodyParts">
                    <i class="fas fa-child"></i> Body Parts
                </button>
                <button class="category-card" data-category-key="clothes">
                    <i class="fas fa-tshirt"></i> Clothes
                </button>
                <button class="category-card" data-category-key="transportation">
                    <i class="fas fa-bus"></i> Transportation
                </button>
                <button class="category-card" data-category-key="occupations">
                    <i class="fas fa-briefcase"></i> Occupations
                </button>
                <button class="category-card" data-category-key="places">
                    <i class="fas fa-map-marker-alt"></i> Places
                </button>
                <button class="category-card" data-category-key="weather">
                    <i class="fas fa-cloud-sun"></i> Weather
                </button>
                <button class="category-card" data-category-key="time">
                    <i class="fas fa-clock"></i> Time
                </button>
            </div>
        </div>

        <div id="learnDefinitionsPage" class="page-content learn-definitions-page">
        </div>

        <div id="practiceCategoriesPage" class="page-content practice-categories-page">
            <h1>Practice Your Darija!</h1>
            <div class="category-grid">
                <button class="category-card" data-game="numbers">
                    <i class="fas fa-calculator"></i> Numbers
                </button>
                <button class="category-card" data-game="days">
                    <i class="fas fa-calendar-alt"></i> Days of the Week
                </button>
                <button class="category-card" data-game="months">
                    <i class="fas fa-calendar-check"></i> Months
                </button>
                <button class="category-card" data-game="colors">
                    <i class="fas fa-palette"></i> Colors
                </button>
                <button class="category-card" data-game="animals">
                    <i class="fas fa-paw"></i> Animals
                </button>
                <button class="category-card" data-game="food">
                    <i class="fas fa-utensils"></i> Food
                </button>
                <button class="category-card" data-game="greetings">
                    <i class="fas fa-handshake"></i> Greetings
                </button>
                <button class="category-card" data-game="family">
                    <i class="fas fa-users"></i> Family
                </button>
                <button class="category-card" data-game="bodyParts">
                    <i class="fas fa-child"></i> Body Parts
                </button>
                <button class="category-card" data-game="clothes">
                    <i class="fas fa-tshirt"></i> Clothes
                </button>
                <button class="category-card" data-game="transportation">
                    <i class="fas fa-bus"></i> Transportation
                </button>
                <button class="category-card" data-game="occupations">
                    <i class="fas fa-briefcase"></i> Occupations
                </button>
                <button class="category-card" data-game="places">
                    <i class="fas fa-map-marker-alt"></i> Places
                </button>
                <button class="category-card" data-game="weather">
                    <i class="fas fa-cloud-sun"></i> Weather
                </button>
                <button class="category-card" data-game="time">
                    <i class="fas fa-clock"></i> Time
                </button>
            </div>
        </div>

        <div id="gamePage" class="page-content game-page">
            <h1 id="gameTitle"></h1>
            <div class="score-display" id="scoreDisplay" role="status" aria-live="polite">Score: 0</div>
            <div class="question-display" id="questionDisplay" aria-atomic="true" aria-live="assertive"></div>
            <input type="text" id="answerInput" class="answer-input" placeholder="Your answer" disabled aria-label="Enter your answer here">
            <div class="feedback-message" id="feedbackMessage" role="alert" aria-live="assertive"></div>
            <button id="startButton" class="action-button">Start Game</button>
            <button id="submitButton" class="action-button" style="display: none;">Submit Answer</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainHomePage = document.getElementById('mainHomePage');
            const learnCategoriesPage = document.getElementById('learnCategoriesPage');
            const learnDefinitionsPage = document.getElementById('learnDefinitionsPage');
            const practiceCategoriesPage = document.getElementById('practiceCategoriesPage');
            const gamePage = document.getElementById('gamePage');
            const gameTitleElement = document.getElementById('gameTitle');
            const backButton = document.getElementById('backButton');

            const questionDisplay = document.getElementById('questionDisplay');
            const answerInput = document.getElementById('answerInput');
            const submitButton = document.getElementById('submitButton');
            const startButton = document.getElementById('startButton');
            const feedbackMessage = document.getElementById('feedbackMessage');
            const scoreDisplay = document.getElementById('scoreDisplay');

            const gameData = {
                numbers: [
                    { english: "zero", darija: "sifr", num: "0" },
                    { english: "one", darija: "wa7ed", num: "1" },
                    { english: "two", darija: "jouj", num: "2" },
                    { english: "three", darija: "tlata", num: "3" },
                    { english: "four", darija: "reb3a", num: "4" },
                    { english: "five", darija: "khemsa", num: "5" },
                    { english: "six", darija: "setta", num: "6" },
                    { english: "seven", darija: "seb3a", num: "7" },
                    { english: "eight", darija: "tmenya", num: "8" },
                    { english: "nine", darija: "tes3oud", num: "9" },
                    { english: "ten", darija: "3achra", num: "10" }
                ],
                days: [
                    { english: "Sunday", darija: "l7edd" },
                    { english: "Monday", darija: "ltnin" },
                    { english: "Tuesday", darija: "ttlat" },
                    { english: "Wednesday", darija: "larb3a" },
                    { english: "Thursday", darija: "lkhamis" },
                    { english: "Friday", darija: "jjum3a" },
                    { english: "Saturday", darija: "ssabtt" }
                ],
                months: [
                    { english: "January", darija: "yanayer" },
                    { english: "February", darija: "febrayer" },
                    { english: "March", darija: "mars" },
                    { english: "April", darija: "abril" },
                    { english: "May", darija: "may" },
                    { english: "June", darija: "yunyu" },
                    { english: "July", darija: "yulyuz" },
                    { english: "August", darija: "ghusht" },
                    { english: "September", darija: "shutnbir" },
                    { english: "October", darija: "uktubar" },
                    { english: "November", darija: "nuwanbir" },
                    { english: "December", darija: "dujanbir" }
                ],
                colors: [
                    { english: "red", darija: "ḥmer" },
                    { english: "blue", darija: "zreq" },
                    { english: "green", darija: "khḍer" },
                    { english: "yellow", darija: "ṣfer" },
                    { english: "black", darija: "kḥel" },
                    { english: "white", darija: "biḍ" },
                    { english: "orange", darija: "limuni" },
                    { english: "purple", darija: "benafseji" },
                    { english: "pink", darija: "werdi" },
                    { english: "brown", darija: "qahwi" },
                    { english: "grey", darija: "ramadi" }
                ],
                animals: [
                    { english: "dog", darija: "kelb" },
                    { english: "cat", darija: "qet" },
                    { english: "bird", darija: "ṭir" },
                    { english: "fish", darija: "ḥout" },
                    { english: "lion", darija: "sbeʿ" },
                    { english: "elephant", darija: "fil" },
                    { english: "horse", darija: "ʿawd" },
                    { english: "cow", darija: "begra" },
                    { english: "sheep", darija: "ḥawli" },
                    { english: "chicken", darija: "djej" }
                ],
                food: [
                    { english: "bread", darija: "khobz" },
                    { english: "water", darija: "ma" },
                    { english: "tea", darija: "atay" },
                    { english: "apple", darija: "teffaḥ" },
                    { english: "banana", darija: "banan" },
                    { english: "meat", darija: "lḥem" },
                    { english: "chicken", darija: "djej" },
                    { english: "egg", darija: "biḍa" },
                    { english: "milk", darija: "ḥlib" },
                    { english: "orange juice", darija: "3aṣir limoun" }
                ],
                greetings: [
                    { english: "hello", darija: "salam" },
                    { english: "goodbye", darija: "bslama" },
                    { english: "thank you", darija: "shukran" },
                    { english: "please", darija: "3afak" },
                    { english: "yes", darija: "iyyeh" },
                    { english: "no", darija: "lla" },
                    { english: "how are you?", darija: "kif dayr?" },
                    { english: "welcome", darija: "marḥba" },
                    { english: "good morning", darija: "sbaḥ lkhir" },
                    { english: "good evening", darija: "msa lkhir" }
                ],
                family: [
                    { english: "mother", darija: "mmi" },
                    { english: "father", darija: "bba" },
                    { english: "brother", darija: "khuya" },
                    { english: "sister", darija: "khti" },
                    { english: "son", darija: "weld" },
                    { english: "daughter", darija: "bent" },
                    { english: "grandfather", darija: "jeddi" },
                    { english: "grandmother", darija: "jeddati" },
                    { english: "uncle (paternal)", darija: "3emmi" },
                    { english: "aunt (paternal)", darija: "3emmeti" }
                ],
                bodyParts: [
                    { english: "hand", darija: "yed" },
                    { english: "foot", darija: "rejel" },
                    { english: "head", darija: "ras" },
                    { english: "eye", darija: "3in" },
                    { english: "mouth", darija: "fomm" },
                    { english: "nose", darija: "nif" },
                    { english: "ear", darija: "wedn" },
                    { english: "arm", darija: "dra3" },
                    { english: "leg", darija: "saq" },
                    { english: "hair", darija: "sha3r" }
                ],
                clothes: [
                    { english: "shirt", darija: "qamija" },
                    { english: "pants", darija: "serwal" },
                    { english: "dress", darija: "kswa" },
                    { english: "shoes", darija: "sabbat" },
                    { english: "hat", darija: "ṭarboosh" },
                    { english: "jacket", darija: "vesta" },
                    { english: "skirt", darija: "sayya" },
                    { english: "socks", darija: "tqašer" },
                    { english: "scarf", darija: "zif" },
                    { english: "gloves", darija: "ligat" }
                ],
                transportation: [
                    { english: "car", darija: "ṭomobil" },
                    { english: "bus", darija: "kar" },
                    { english: "train", darija: "train" },
                    { english: "bicycle", darija: "biškliṭa" },
                    { english: "plane", darija: "ṭayyara" },
                    { english: "motorcycle", darija: "motor" },
                    { english: "boat", darija: "flouka" },
                    { english: "taxi", darija: "taxi" },
                    { english: "metro", darija: "metro" },
                    { english: "tram", darija: "tram" }
                ],
                occupations: [
                    { english: "teacher", darija: "ostad" },
                    { english: "doctor", darija: "ṭbib" },
                    { english: "student", darija: "talib" },
                    { english: "engineer", darija: "muhandis" },
                    { english: "farmer", darija: "fellaḥ" },
                    { english: "police officer", darija: "bolisi" },
                    { english: "shopkeeper", darija: "mol lḥanot" },
                    { english: "driver", darija: "shafor" },
                    { english: "cook", darija: "ṭabbakh" },
                    { english: "artist", darija: "fennan" }
                ],
                places: [
                    { english: "house", darija: "dar" },
                    { english: "school", darija: "madrasa" },
                    { english: "market", darija: "souq" },
                    { english: "hospital", darija: "sbiṭar" },
                    { english: "restaurant", darija: "maṭ3am" },
                    { english: "city", darija: "mdina" },
                    { english: "village", darija: "douar" },
                    { english: "mosque", darija: "jam3" },
                    { english: "beach", darija: "plaža" },
                    { english: "park", darija: "jardin" }
                ],
                weather: [
                    { english: "sun", darija: "shems" },
                    { english: "rain", darija: "shta" },
                    { english: "cold", darija: "berd" },
                    { english: "hot", darija: "sakhun" },
                    { english: "wind", darija: "riḥ" },
                    { english: "cloud", darija: "nuba" },
                    { english: "snow", darija: "telj" },
                    { english: "storm", darija: "3aṣifa" },
                    { english: "sunny", darija: "mshmish" },
                    { english: "cloudy", darija: "mghayem" }
                ],
                time: [
                    { english: "hour", darija: "sa3a" },
                    { english: "minute", darija: "dqiq" },
                    { english: "second", darija: "tanya" },
                    { english: "morning", darija: "sbaḥ" },
                    { english: "evening", darija: "3chiya" },
                    { english: "night", darija: "lil" },
                    { english: "day", darija: "nhar" },
                    { english: "week", darija: "simana" },
                    { english: "month", darija: "shehr" },
                    { english: "year", darija: "3am" }
                ]
            };

            let currentCategoryData = null;
            let currentQuestion = null;
            let score = 0;
            let gameActive = false;
            let currentPageId = 'mainHomePage';

            const pages = {
                mainHomePage: mainHomePage,
                learnCategoriesPage: learnCategoriesPage,
                learnDefinitionsPage: learnDefinitionsPage,
                practiceCategoriesPage: practiceCategoriesPage,
                gamePage: gamePage
            };

            function showPage(pageId) {
                if (currentPageId === pageId && pages[pageId].classList.contains('active')) {
                    return;
                }

                const prevPageElement = pages[currentPageId];
                const nextPageElement = pages[pageId];

                if (prevPageElement) {
                    prevPageElement.classList.remove('active');
                }

                // Hide all pages first, then show the target one
                Object.values(pages).forEach(page => {
                    page.style.display = 'none';
                });

                nextPageElement.style.display = 'flex'; // Ensure the target page is flex
                setTimeout(() => {
                    nextPageElement.classList.add('active');
                }, 10); // Small delay for display property to apply before transition

                currentPageId = pageId;
                updateBackButtonVisibility();
            }

            function updateBackButtonVisibility() {
                if (currentPageId !== 'mainHomePage') {
                    backButton.classList.add('active');
                } else {
                    backButton.classList.remove('active');
                }
            }

            function goBack() {
                let targetPageId = 'mainHomePage';

                if (currentPageId === 'learnCategoriesPage' || currentPageId === 'practiceCategoriesPage') {
                    targetPageId = 'mainHomePage';
                } else if (currentPageId === 'learnDefinitionsPage') {
                    targetPageId = 'learnCategoriesPage';
                } else if (currentPageId === 'gamePage') {
                    targetPageId = 'practiceCategoriesPage';
                    gameActive = false;
                }
                showPage(targetPageId);
            }

            function generateLearnDefinitionsContent(categoryKey) {
                const definitionsContainer = learnDefinitionsPage;
                const categoryData = gameData[categoryKey];
                const categoryDisplayName = categoryKey.charAt(0).toUpperCase() + categoryKey.slice(1).replace(/([A-Z])/g, ' $1').trim();

                if (!categoryData) {
                    definitionsContainer.innerHTML = `<h1>Definitions for ${categoryDisplayName}</h1><p>No data found for this category.</p>`;
                    return;
                }

                let contentHtml = `<h1>${categoryDisplayName} Definitions</h1>`;
                contentHtml += `<div class="learn-word-list">`;

                categoryData.forEach(item => {
                    let englishDisplay = item.english;
                    if (categoryKey === 'numbers' && item.num) {
                        englishDisplay = `${item.english} (${item.num})`;
                    }
                    contentHtml += `
                        <div class="learn-word-item" tabindex="0" role="listitem" aria-label="${item.english} in English, ${item.darija} in Darija">
                            <span class="english-word">${englishDisplay}</span>
                            <span class="darija-word">${item.darija}</span>
                        </div>
                    `;
                });
                contentHtml += `</div>`;
                definitionsContainer.innerHTML = contentHtml;
            }

            function loadGame(category) {
                currentCategoryData = gameData[category];
                if (!currentCategoryData || currentCategoryData.length === 0) {
                    console.error('Invalid or empty game category:', category);
                    alert('Sorry, no game data available for this category yet!');
                    return;
                }

                let titleText = '';
                switch (category) {
                    case 'numbers': titleText = 'Numbers Game!'; break;
                    case 'days': titleText = 'Days of the Week Game!'; break;
                    case 'months': titleText = 'Months Game!'; break;
                    case 'colors': titleText = 'Colors Game!'; break;
                    case 'animals': titleText = 'Animals Game!'; break;
                    case 'food': titleText = 'Food Game!'; break;
                    case 'greetings': titleText = 'Greetings Game!'; break;
                    case 'family': titleText = 'Family Game!'; break;
                    case 'bodyParts': titleText = 'Body Parts Game!'; break;
                    case 'clothes': titleText = 'Clothes Game!'; break;
                    case 'transportation': titleText = 'Transportation Game!'; break;
                    case 'occupations': titleText = 'Occupations Game!'; break;
                    case 'places': titleText = 'Places Game!'; break;
                    case 'weather': titleText = 'Weather Game!'; break;
                    case 'time': titleText = 'Time Terms Game!'; break;
                    default: titleText = 'Darija Practice!';
                }
                gameTitleElement.textContent = titleText;

                score = 0;
                gameActive = false;
                scoreDisplay.textContent = `Score: ${score}`;
                feedbackMessage.textContent = '';
                feedbackMessage.className = 'feedback-message';
                answerInput.value = '';
                answerInput.disabled = true;
                startButton.style.display = 'flex';
                submitButton.style.display = 'none';
                questionDisplay.textContent = 'Press "Start Game" to begin!';

                showPage('gamePage');
            }

            function startGame() {
                score = 0;
                scoreDisplay.textContent = `Score: ${score}`;
                feedbackMessage.textContent = '';
                feedbackMessage.className = 'feedback-message';
                answerInput.value = '';
                answerInput.disabled = false;
                startButton.style.display = 'none';
                submitButton.style.display = 'flex';
                answerInput.focus();
                gameActive = true;
                generateQuestion();
            }

            function generateQuestion() {
                if (!currentCategoryData || currentCategoryData.length === 0) {
                    questionDisplay.textContent = "No data for this game category!";
                    answerInput.disabled = true;
                    submitButton.style.display = 'none';
                    return;
                }

                questionDisplay.style.opacity = '0';
                questionDisplay.style.transform = 'scale(0.95)';

                setTimeout(() => {
                    feedbackMessage.textContent = '';
                    feedbackMessage.className = 'feedback-message';

                    const randomIndex = Math.floor(Math.random() * currentCategoryData.length);
                    const selectedItem = currentCategoryData[randomIndex];

                    const hasNum = selectedItem.hasOwnProperty('num');
                    const questionType = Math.random() < 0.5 ? 0 : 1;

                    if (questionType === 0) {
                        questionDisplay.textContent = selectedItem.english.toUpperCase();
                        currentQuestion = {
                            question: selectedItem.english.toUpperCase(),
                            answer: selectedItem.darija.toLowerCase(),
                            type: 'darija'
                        };
                    } else {
                        questionDisplay.textContent = selectedItem.darija.toUpperCase();
                        currentQuestion = {
                            question: selectedItem.darija.toUpperCase(),
                            answer: hasNum ? selectedItem.num.toLowerCase() : selectedItem.english.toLowerCase(),
                            type: hasNum ? 'english_num' : 'english_word'
                        };
                    }
                    answerInput.value = '';
                    answerInput.focus();

                    questionDisplay.style.opacity = '1';
                    questionDisplay.style.transform = 'scale(1)';
                }, 300);
            }

            function cleanAnswer(answer) {
                return answer.replace(/é/g, 'e')
                             .replace(/è/g, 'e')
                             .replace(/à/g, 'a')
                             .replace(/ù/g, 'u')
                             .replace(/ç/g, 'c')
                             .replace(/ṣ/g, 's')
                             .replace(/ḍ/g, 'd')
                             .replace(/ṭ/g, 't')
                             .replace(/ḥ/g, 'h')
                             .replace(/ẓ/g, 'z')
                             .replace(/ʿ/g, '3')
                             .replace(/gh/g, 'gh')
                             .replace(/kh/g, 'kh')
                             .replace(/sh/g, 'sh')
                             .replace(/ch/g, 'ch')
                             .toLowerCase()
                             .trim();
            }

            function checkAnswer() {
                if (!gameActive || answerInput.disabled) return;

                const userAnswer = cleanAnswer(answerInput.value);
                let isCorrect = false;
                let correctAnswerDisplay = "";

                if (currentQuestion.type === 'darija') {
                    isCorrect = userAnswer === cleanAnswer(currentQuestion.answer);
                    correctAnswerDisplay = currentQuestion.answer;
                } else if (currentQuestion.type === 'english_num') {
                    const correctEnglishWordItem = gameData.numbers.find(d => cleanAnswer(d.num) === cleanAnswer(currentQuestion.answer));
                    const correctEnglishWord = correctEnglishWordItem ? cleanAnswer(correctEnglishWordItem.english) : '';
                    isCorrect = (userAnswer === cleanAnswer(currentQuestion.answer) || userAnswer === correctEnglishWord);
                    correctAnswerDisplay = correctEnglishWordItem ? `${correctEnglishWordItem.english} (${correctEnglishWordItem.num})` : currentQuestion.answer;
                } else if (currentQuestion.type === 'english_word') {
                    isCorrect = userAnswer === cleanAnswer(currentQuestion.answer);
                    correctAnswerDisplay = currentQuestion.answer;
                }

                if (isCorrect) {
                    feedbackMessage.textContent = 'Correct! 🎉';
                    feedbackMessage.classList.add('correct');
                    feedbackMessage.classList.remove('incorrect');
                    score++;
                } else {
                    feedbackMessage.textContent = `Incorrect. The correct answer was "${correctAnswerDisplay}".`;
                    feedbackMessage.classList.add('incorrect');
                    feedbackMessage.classList.remove('correct');
                    score = Math.max(0, score - 1);
                }
                scoreDisplay.textContent = `Score: ${score}`;

                answerInput.disabled = true;
                setTimeout(() => {
                    answerInput.disabled = false;
                    generateQuestion();
                }, 1500);
            }

            document.querySelectorAll('.main-category-grid .primary-card').forEach(button => {
                button.addEventListener('click', (event) => {
                    const targetPage = event.currentTarget.dataset.targetPage;
                    showPage(targetPage);
                });
            });

            document.querySelectorAll('#learnCategoriesPage .category-card').forEach(button => {
                button.addEventListener('click', (event) => {
                    const categoryKey = event.currentTarget.dataset.categoryKey;
                    generateLearnDefinitionsContent(categoryKey);
                    showPage('learnDefinitionsPage');
                });
            });

            document.querySelectorAll('#practiceCategoriesPage .category-card').forEach(button => {
                button.addEventListener('click', (event) => {
                    const gameType = event.currentTarget.dataset.game;
                    loadGame(gameType);
                });
            });

            startButton.addEventListener('click', startGame);
            submitButton.addEventListener('click', checkAnswer);

            backButton.addEventListener('click', goBack);

            answerInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter' && gameActive && !answerInput.disabled) {
                    checkAnswer();
                }
            });

            showPage('mainHomePage');
        });
    </script>
</body>
</html>
